machine:
  php:
    version: 7.0.4

checkout:
  post:
    - git submodule sync
    - git submodule update --init
    - ln -s ../vae_thrift tests/dependencies/vae_thrift

dependencies:
  pre:
    - sudo apt-get update; sudo apt-get install libantlr3c-dev
    - cd tests/dependencies/vaeql && make && make install
    - echo "extension=vaeql.so" > ~/.phpenv/versions/$(phpenv global)/etc/conf.d/vaeql.ini

test:
  override:
    - php tests/_all.php
